<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>POS — Input & Table Structure (Demo)</title>
  <style>
    body { font-family: system-ui, -apple-system, Arial; padding: 24px; max-width:800px; margin:0 auto; }
    label{display:block;margin-top:10px;font-weight:600}
    input, select, button { padding:8px; font-size:14px; width:100%; box-sizing:border-box }
    .row{display:flex;gap:8px}
    .row > *{flex:1}
    .card{border:1px solid #eee;padding:12px;border-radius:8px;margin-top:12px}
    pre{background:#f7f7f7;padding:12px;border-radius:6px;overflow:auto}
  </style>
</head>
<body>
  <h2>POS — Input (Demo)</h2>

  <div class="card">
    <label for="tableDesc">Table Description (required)</label>
    <input id="tableDesc" placeholder="Table 1 / John - Table / Window seat" required />

    <label for="orderTag">Order Tag</label>
    <input id="orderTag" placeholder="Single Order" value="Single Order" />

    <div class="row">
      <div>
        <label for="section">Section</label>
        <select id="section">
          <option value="Food">Food</option>
          <option value="Drinks">Drinks</option>
        </select>
      </div>

      <div>
        <label for="item">Item</label>
        <select id="item"></select>
      </div>

      <div style="max-width:110px">
        <label for="qty">Qty</label>
        <input id="qty" type="number" min="1" value="1" />
      </div>
    </div>

    <button id="placeOrderBtn">Place order</button>
  </div>

  <div class="card">
    <h3>posData (current snapshot)</h3>
    <pre id="snapshot">(no orders yet)</pre>
    <p style="font-size:13px;color:#666">Snapshot of posData object</p>
  </div>

  <div class="card">
    <h3>Tables & Orders</h3>
    <div id="tables"></div>
  </div>

  <script>
    const MENU = { Food: ["Burger", "Pizza", "Salad", "Pasta"], Drinks: ["Water", "Soda", "Coffee", "Juice"] };
    const posData = { openOrders: [], closedOrders: [], problemOrders: [] };
    const $ = id => document.getElementById(id);
    const snapshotEl = $('snapshot');

    function populateItems(section){
      const itemSelect = $('item');
      itemSelect.innerHTML = '';
      MENU[section].forEach(it => {
        const opt = document.createElement('option');
        opt.value = it; opt.textContent = it; itemSelect.appendChild(opt);
      });
    }

    function uid(prefix = ''){ return prefix + Date.now().toString(36) + Math.random().toString(36).slice(2,7); }

    function updateSnapshot(){ snapshotEl.textContent = JSON.stringify(posData, null, 2); }

    function findTable(tableDescription){ return posData.openOrders.find(t => t.tableDescription === tableDescription); }

    function placeOrder({tableDescription, orderTag, section, item, qty}){
      const timestamp = new Date().toISOString();
      const order = { orderId: uid('ORD-'), orderTag: orderTag || 'Single Order', section, item, qty: Number(qty) || 1, timestampCreated: timestamp, orderStatus: 'open' };
      let table = findTable(tableDescription);
      if(!table){ table = { tableId: uid('TBL-'), tableDescription, status: 'occupied', createdAt: timestamp, orders: [] }; posData.openOrders.push(table); }
      table.orders.push(order);
      updateSnapshot(); renderTables();
    }

    function renderTables(){
      const container = document.getElementById('tables');
      container.innerHTML = '';
      posData.openOrders.forEach(table => {
        const div = document.createElement('div');
        div.style.border = '1px solid #ddd'; div.style.padding = '8px'; div.style.marginBottom = '8px'; div.style.borderRadius = '6px';
        div.innerHTML = `<strong>${table.tableDescription}</strong><br>` + table.orders.map(o=>`- ${o.orderTag}: ${o.qty} x ${o.item}`).join('<br>');
        container.appendChild(div);
      });
    }

    $('section').addEventListener('change', e => populateItems(e.target.value));
    populateItems($('section').value);

    $('placeOrderBtn').addEventListener('click', () => {
      const tableDescription = $('tableDesc').value.trim();
      if(!tableDescription){ alert('Table Description is required.'); return; }
      const payload = { tableDescription, orderTag: $('orderTag').value.trim() || 'Single Order', section: $('section').value, item: $('item').value, qty: $('qty').value };
      placeOrder(payload);
      $('orderTag').value = 'Single Order'; $('qty').value = 1;
    });

    updateSnapshot(); renderTables();
  </script>
</body>
</html>
